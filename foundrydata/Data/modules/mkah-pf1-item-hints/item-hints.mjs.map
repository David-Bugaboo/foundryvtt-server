{
  "version": 3,
  "sources": ["../src/config.mjs", "../src/hint.mjs", "../src/common.mjs", "../src/i18n.mjs", "../src/compatibility/gm-notes-handler.mjs", "../src/loader.mjs", "../src/settings.mjs", "../src/editor.mjs", "../src/handlers/custom.mjs", "../src/create-hints.mjs", "../src/handlers/actions.mjs", "../src/handlers/attack.mjs", "../src/handlers/damage.mjs", "../src/handlers/changeflags.mjs", "../src/handlers/changes.mjs", "../src/components/uniform-object.mjs", "../src/handlers/class.mjs", "../src/handlers/container.mjs", "../src/handlers/item.mjs", "../src/handlers/proficiency.mjs", "../src/handlers/saves.mjs", "../src/handlers/spell.mjs", "../src/handlers/value.mjs", "../src/handlers/scripts.mjs", "../src/handlers/manager.mjs", "../src/components/app-context.mjs", "../src/handler-options.mjs", "../src/item-hints.mjs"],
  "sourcesContent": [
    "export const CFG = /** @type {const} */ ({\n\tid: 'mkah-pf1-item-hints',\n\tCSS: {\n\t\tbranding: 'koboldworks',\n\t\tcommon: 'item-hints',\n\t\tprops: 'hint-item-properties',\n\t},\n\tSETTING: {\n\t\tcustomHint: 'itemHints',\n\t\ticonizeSetting: 'iconize',\n\t\tshowAllValues: 'allValued',\n\t\tglow: 'glow',\n\t\tmaxLabelLength: 'maxLabelLength',\n\t\taura: 'aura',\n\t\tcombo: 'combo',\n\t\tschoolAura: 'iconizeAura',\n\t\tshowChanges: 'changes',\n\t\tsanity: 'sanity',\n\t\thomebrew: 'homebrew',\n\t\tunlang: 'nonstandardLang',\n\t},\n});\n\nconst templates = {\n\t'item-hints-editor': `modules/${CFG.id}/templates/editor.hbs`,\n};\n\nHooks.once('setup', () => loadTemplates(templates));\n",
    "import { CFG } from './config.mjs';\n\nexport class Hint {\n\t/**\n\t * Plain label when icon nor image is not used. Used as tooltip hint with iconized enabled and no explicit hint provided.\n\t */\n\tlabel;\n\t/**\n\t * Font awesome icon.\n\t */\n\ticon;\n\t/**\n\t * Actual image file.\n\t */\n\timage;\n\t/**\n\t * Tooltip text.\n\t */\n\thint;\n\t/**\n\t * Additional CSS classes.\n\t */\n\tadditionalClasses;\n\t/**\n\t * Is this combo hint?\n\t */\n\tcombo;\n\t/**\n\t * If true, the hint is marked as 'tag' instead of 'hint', used by weapon properties.\n\t */\n\tinBuiltTag;\n\n\t/**\n\t * @param label Display label.\n\t * @param {Array<string>} classes Array of HTML classes to add to identify the hint.\n\t * @param {string} hint Tooltip text.\n\t * @param {string} icon Font awesome icon class.\n\t * @param {string} image URL to image file.\n\t * @param {boolean} inbuilt Inbuilt tag. Used for weapon properties.\n\t */\n\tconstructor(label, classes = [], { hint = null, icon = null, image = null, inbuilt = false, combo = false } = {}) {\n\t\tthis.label = label;\n\t\tthis.hint = hint;\n\t\tthis.icon = icon;\n\t\tthis.image = image;\n\t\tthis.additionalClasses = classes;\n\t\tthis.inBuiltTag = inbuilt;\n\t\tthis.combo = combo;\n\t}\n\n\tclone() {\n\t\treturn new this.constructor(this.label, [...this.additionalClasses], { hint: this.hint, icon: this.icon, image: this.image, inbuilt: this.inBuiltTag });\n\t}\n\n\t/**\n\t * Same as new Hint(), just better for chaining.\n\t *\n\t * @param label Display label.\n\t * @param {Array<string>} classes Array of HTML classes to add to identify the hint.\n\t * @param {string} hint Tooltip text.\n\t * @param {string} icon Font awesome icon class.\n\t * @param {string} image URL to image file.\n\t * @param {boolean} inbuilt Inbuilt tag. Used for weapon properties.\n\t */\n\tstatic create(label, classes = [], { hint = null, icon = null, image = null, inbuilt = false, combo = false } = {}) {\n\t\tconst comboType = game.settings.get(CFG.id, CFG.SETTING.combo);\n\t\tswitch (comboType) {\n\t\t\tcase 'always':\n\t\t\t\tcombo = true;\n\t\t\t\tbreak;\n\t\t\tcase 'never':\n\t\t\t\tcombo = false;\n\t\t\t\tbreak;\n\t\t}\n\t\treturn new Hint(label, classes, { hint, icon, image, inbuilt, combo });\n\t}\n\n\t/**\n\t * @param {boolean} iconize Use icons or images where possible.\n\t * @returns {HTMLElement} element for the hint\n\t */\n\telement(iconize = false) {\n\t\tconst IMAGE = 2, ICON = 1;\n\n\t\tconst isIcon = (iconize && (this.icon || this.image)) || (this.combo && this.icon);\n\t\tconst type = isIcon ? this.image ? IMAGE : ICON : 0;\n\n\t\tif (this.icon && !Array.isArray(this.icon))\n\t\t\tthis.icon = this.icon?.split(' ');\n\n\t\tlet hint;\n\n\t\tconst el = document.createElement('span');\n\t\tel.classList.add(this.inBuiltTag ? 'tag' : 'item-hint');\n\n\t\tswitch (type) {\n\t\t\tcase IMAGE: { // image\n\t\t\t\tconst img = document.createElement('img');\n\t\t\t\timg.src = this.image;\n\t\t\t\tel.append(img);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase ICON: { // icon\n\t\t\t\tconst icon = document.createElement('i');\n\t\t\t\ticon.classList.add(...this.icon);\n\t\t\t\tel.append(icon);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (this.combo || !isIcon) {\n\t\t\tconst text = document.createElement('span');\n\t\t\ttext.innerHTML = this.label;\n\t\t\tif (isIcon) el.append(' ');\n\t\t\tel.append(text);\n\t\t\tif (this.hint) hint = this.hint;\n\n\t\t\tel.classList.add('text-hint');\n\t\t}\n\t\telse {\n\t\t\tel.classList.add('iconized');\n\t\t}\n\n\t\tif (this.combo) el.classList.add('combo');\n\n\t\tif (isIcon) {\n\t\t\tconst tip = this.hint ?? this.label;\n\t\t\tif (tip) hint = tip;\n\t\t}\n\n\t\tif (hint) {\n\t\t\tel.dataset.tooltip = hint.replace(/\\n/g, '<br>');\n\t\t\tel.dataset.tooltipDirection = 'UP';\n\t\t}\n\n\t\tel.classList.add(...this.additionalClasses);\n\n\t\treturn el;\n\t}\n}\n",
    "import { CFG } from './config.mjs';\nimport { Hint } from './hint.mjs';\n\nexport const itemHandlers = [];\nexport const exItemHandlers = [];\n\n/**\n * @param {string} id - Template ID\n * @param {object} data - Template data\n * @returns {HTMLElement}\n */\nexport function renderIHTemplate(id, data) {\n\tconst handlebarsOptions = {\n\t\tallowProtoMethodsByDefault: true,\n\t\tallowProtoPropertiesByDefault: true,\n\t\tpreventIndent: true,\n\t};\n\n\tconst d = document.createElement('div');\n\td.innerHTML = Handlebars.partials[id](data, handlebarsOptions);\n\treturn d.firstElementChild;\n}\n\nexport async function migrateHints(item) {\n\t// Test if we can edit\n\tif (!item.isOwner) return;\n\tconst pack = game.packs.get(item.pack);\n\tif (pack?.locked) return;\n\n\t// Migrate proper\n\tconst key = CFG.SETTING.customHint;\n\tconst hint = item.getItemDictionaryFlag(key);\n\tif (hint) {\n\t\tconsole.log('Item Hints üéü | Migration |', item.name, item.id);\n\t\tconst itemUpdate = {\n\t\t\tsystem: {\n\t\t\t\tflags: {\n\t\t\t\t\tdictionary: {\n\t\t\t\t\t\t[`-=${key}`]: null,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tflags: {\n\t\t\t\tworld: {\n\t\t\t\t\t[key]: hint,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t\treturn item.update(itemUpdate, { render: false });\n\t}\n}\n\nexport function getHint(item) {\n\tlet customHints = item.getItemDictionaryFlag(CFG.SETTING.customHint);\n\tif (customHints) migrateHints(item);\n\tcustomHints ||= item.getFlag('world', CFG.SETTING.customHint);\n\treturn customHints;\n}\n\nexport function createNode(node = 'span', text = '', classes = [], { tooltip = null } = {}) {\n\tconst n = document.createElement(node);\n\tn.textContent = text;\n\tif (classes.length) n.classList.add(...classes);\n\tif (tooltip) n.dataset.tooltip = tooltip;\n\treturn n;\n}\n\nexport const descriptorIcons = {\n\tmaterial: new Hint('', ['material'], { icon: 'fa-solid fa-coins' }),\n\tvalue: new Hint('', ['value'], { icon: 'fa-solid fa-coins' }),\n\tinconsistency: new Hint('', ['inconsistency'], { icon: 'fa-solid fa-exclamation-circle' }),\n};\n",
    "export class i18n {\n\t/**\n\t * Tests if translation key exists.\n\t *\n\t * @param {string} string\n\t * @returns {boolean} - Whether the i18n string exists.\n\t */\n\tstatic has = (string) => game.i18n.has(string);\n\n\t/**\n\t * @param {string} string i18n string path\n\t * @param {Record<string,string>} [mapping] - Mapping of keys to strings\n\t * @returns {string} - Localized string\n\t */\n\tstatic get = (string, mapping) => mapping ? game.i18n.format(string, mapping) : game.i18n.localize(string);\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { itemHandlers } from '../common.mjs';\nimport { i18n } from '../i18n.mjs';\n\nfunction gmNotesHandler(options, hints) {\n\tif (!game.user.isGM) return;\n\tconst item = options.item;\n\n\tconst notes = item.getFlag('gm-notes', 'notes');\n\tif (notes === undefined) return;\n\n\thints.append(\n\t\tHint.create(i18n.get('GMNote.label'), ['module', 'gm-notes'],\n\t\t\t{ hint: i18n.get('Koboldworks.Module.GMNotes.NotesFound'), icon: 'fa-solid fa-clipboard-check' },\n\t\t).element(options.iconize));\n}\n\nitemHandlers.push(gmNotesHandler);\n",
    "Hooks.once('ready', () => {\n\tif (game.modules.get('gm-notes')?.active)\n\t\timport('./compatibility/gm-notes-handler.mjs')\n\t\t\t.then(() => console.log('Item Hints üéü | Compatibility | GM Notes'));\n});\n",
    "import { CFG } from './config.mjs';\nimport { Hint } from './hint.mjs';\nimport { exItemHandlers } from './common.mjs';\n\nHooks.once('init', () => {\n\tgame.settings.register(CFG.id, CFG.SETTING.iconizeSetting, {\n\t\tname: 'Koboldworks.ItemHint.IconizeLabel',\n\t\thint: 'Koboldworks.ItemHint.IconizeHint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.aura, {\n\t\tname: 'Koboldworks.ItemHint.AuraLabel',\n\t\thint: 'Koboldworks.ItemHint.AuraHint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.schoolAura, {\n\t\tname: 'Koboldworks.ItemHint.IconizeSchoolLabel',\n\t\thint: 'Koboldworks.ItemHint.IconizeSchoolHint',\n\t\ttype: String,\n\t\tchoices: {\n\t\t\tletters: 'Koboldworks.ItemHint.Icons.Letters',\n\t\t\tletterswcl: 'Koboldworks.ItemHint.Icons.LettersWithCL',\n\t\t\tcustom: 'Koboldworks.ItemHint.Icons.Custom',\n\t\t\trunes: 'Koboldworks.ItemHint.Icons.Runes',\n\t\t},\n\t\tdefault: 'letters',\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.showChanges, {\n\t\tname: 'Koboldworks.ItemHint.ChangeLabel',\n\t\thint: 'Koboldworks.ItemHint.ChangeHint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.showAllValues, {\n\t\tname: 'Koboldworks.ItemHint.ValueLabel',\n\t\thint: 'Koboldworks.ItemHint.ValueHint',\n\t\ttype: String,\n\t\tchoices: {\n\t\t\ttradegoods: 'Koboldworks.ItemHint.Value.TradeGoodsOnly',\n\t\t\tcontainers: 'Koboldworks.ItemHint.Value.TradeGoodsAndContainers',\n\t\t\texpanded: 'Koboldworks.ItemHint.Value.Expanded',\n\t\t\tall: 'Koboldworks.ItemHint.Value.All',\n\t\t\tnone: 'Koboldworks.ItemHint.Value.None',\n\t\t},\n\t\tdefault: 'expanded',\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.maxLabelLength, {\n\t\tname: 'Koboldworks.ItemHint.MaxLabelLength',\n\t\thint: 'Koboldworks.ItemHint.MaxLabelLengthHint',\n\t\ttype: Number,\n\t\trange: {\n\t\t\tmin: 8,\n\t\t\tmax: 80,\n\t\t\tstep: 1,\n\t\t},\n\t\tdefault: 42,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.combo, {\n\t\tname: 'Koboldworks.ItemHint.Combo.Label',\n\t\thint: 'Koboldworks.ItemHint.Combo.Hint',\n\t\ttype: String,\n\t\tchoices: {\n\t\t\talways: 'Koboldworks.ItemHint.Combo.Always',\n\t\t\texplicit: 'Koboldworks.ItemHint.Combo.Explicit',\n\t\t\tnever: 'Koboldworks.ItemHint.Combo.Never',\n\t\t},\n\t\tdefault: 'explicit',\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.glow, {\n\t\tname: 'Koboldworks.ItemHint.Glow.Label',\n\t\thint: 'Koboldworks.ItemHint.Glow.Hint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.sanity, {\n\t\tname: 'Koboldworks.ItemHint.SanityLabel',\n\t\thint: 'Koboldworks.ItemHint.SanityHint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.homebrew, {\n\t\tname: 'Koboldworks.ItemHint.HomebrewLabel',\n\t\thint: 'Koboldworks.ItemHint.HomebrewHint',\n\t\ttype: Boolean,\n\t\tdefault: false,\n\t\tconfig: true,\n\t\tscope: 'world',\n\t});\n\n\tgame.settings.register(CFG.id, CFG.SETTING.unlang, {\n\t\tname: 'Koboldworks.ItemHint.LangLabel',\n\t\thint: 'Koboldworks.ItemHint.LangHint',\n\t\ttype: Boolean,\n\t\tdefault: true,\n\t\tconfig: true,\n\t\tscope: 'client',\n\t});\n\n\tconst module = game.modules.get(CFG.id);\n\n\tmodule.api = {\n\t\tHintClass: Hint,\n\t\taddHandler: (callback) => exItemHandlers.push(callback),\n\t};\n\n\tconsole.log(`Item Hints üéü | ${module.version} | READY`);\n});\n",
    "import { CFG } from './config.mjs';\nimport { renderIHTemplate, getHint } from './common.mjs';\nimport { handleCustomHints } from './handlers/custom.mjs';\nimport { createHints } from './create-hints.mjs';\nimport { AppContext } from './components/app-context.mjs';\nimport { HandlerOptions } from './handler-options.mjs';\n\n/**\n * @param {ItemSheet} sheet\n * @param {HTMLElement} html\n */\nexport async function renderCustomHintEditor(sheet, html) {\n\tif (html instanceof jQuery) html = html[0];\n\n\tconst item = sheet.item, actor = sheet.actor;\n\tif (sheet.__modItemHintsDisableCustom) return;\n\n\tasync function _onCustomHintChange(ev) {\n\t\tconst newValue = ev.target.value.trim();\n\t\treturn newValue?.length > 0 ? item.setFlag('world', CFG.SETTING.customHint, newValue) : item.unsetFlag('world', CFG.SETTING.customHint);\n\t}\n\n\tconst advTab = html.querySelector('.tab[data-tab=\"advanced\"]');\n\tif (!advTab) return;\n\n\ttry {\n\t\tconst value = getHint(item);\n\n\t\tconst templateData = {\n\t\t\tvalue,\n\t\t};\n\n\t\t/** @type {HTMLFieldSetElement} */\n\t\tconst node = renderIHTemplate('item-hints-editor', templateData);\n\n\t\tconst input = node.querySelector('input');\n\t\tif (sheet.isEditable)\n\t\t\tinput.addEventListener('change', _onCustomHintChange);\n\t\telse {\n\t\t\tnode.disabled = true;\n\t\t\tnode.ariaReadOnly = true;\n\t\t}\n\n\t\tconst context = new AppContext(sheet, node);\n\t\tconst opts = new HandlerOptions(item, node, context);\n\t\topts.simulation = true;\n\t\tconst hints = node.querySelector('.item-hints.koboldworks');\n\t\tcreateHints(opts).then(actualHints => {\n\t\t\tif (actualHints.childElementCount == 0) hints.closest('fieldset.example-output').remove();\n\t\t\telse hints.replaceWith(actualHints);\n\t\t});\n\n\t\tadvTab.append(node);\n\t}\n\tcatch (err) {\n\t\tconsole.error(`‚ö†Ô∏è ITEM HINTS | Editor | ${item.name}:`, item, '\\n', err);\n\t\tsheet.item.__modItemHintsDisableCustom = true; // Not meant to be stored in database\n\t}\n}\n",
    "import { CFG } from '../config.mjs';\nimport { Hint } from '../hint.mjs';\nimport { getHint } from '../common.mjs';\n\nexport async function handleCustomHints(o, hints) {\n\ttry {\n\t\tif (o.actor?.sheet?.__modItemHintsDisableCustom) return;\n\n\t\tlet customHints = getHint(o.item);\n\n\t\tif (customHints === undefined) return;\n\t\tif (typeof customHints !== 'string') customHints = customHints.toString();\n\n\t\t// TODO: Add support for custom class tags.\n\t\tfor (const h of customHints.split(';')) {\n\t\t\tconst [label, hint, instructions] = h.split('|', 3);\n\t\t\tconst css = ['custom'];\n\t\t\tif (instructions) {\n\t\t\t\tconst re = instructions.match(/css=(?<css>.*)/);\n\t\t\t\tif (re?.groups.css) css.push(...re.groups.css.split(/\\s+/));\n\t\t\t}\n\t\t\ttry {\n\t\t\t\thints.append(\n\t\t\t\t\tHint.create(\n\t\t\t\t\t\tawait pf1.utils.enrichHTMLUnrolled(label.trim(), { rollData: o.rollData, async: true }),\n\t\t\t\t\t\tcss,\n\t\t\t\t\t\t{ hint: hint?.trim() ?? null },\n\t\t\t\t\t).element(false),\n\t\t\t\t);\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\tconsole.error(err, { label, hint, instructions }, o);\n\t\t\t}\n\t\t}\n\t}\n\tcatch (err) {\n\t\tconsole.error('‚ö†Ô∏è ITEM HINTS | Custom |', o.actor?.name, o.item?.name, { actor: o.actor, item: o.item }, '\\n', err);\n\t\tif (o.actor) {\n\t\t\tconsole.debug('ITEM HINTS | Custom | Error detected; Temporarily disabling for actor:', o.actor.name);\n\t\t\tif (o.actor.sheet)\n\t\t\t\to.actor.sheet.__modItemHintsDisableCustom = true; // Not meant to be stored in database\n\t\t}\n\t}\n}\n",
    "import { CFG } from './config.mjs';\nimport { createNode, itemHandlers, exItemHandlers } from './common.mjs';\nimport { Hint } from './hint.mjs';\nimport { Manager as handler } from './handlers/manager.mjs'; // preload handlers\nimport { AppContext } from './components/app-context.mjs';\nimport { HandlerOptions } from './handler-options.mjs';\n\n/**\n * @param {HandlerOptions} opts\n * @returns {HTMLElement}\n */\nexport async function createHints(opts) {\n\tconst context = opts.context;\n\n\tconst hints = createNode('div', null, [CFG.CSS.branding, CFG.CSS.common]);\n\n\tconst { item } = opts;\n\n\ttry {\n\t\tswitch (item.type) {\n\t\t\tcase 'feat':\n\t\t\t\thandler.damage(opts, hints);\n\t\t\t\tawait handler.saves(opts, hints);\n\t\t\t\thandler.changes(opts, hints);\n\t\t\t\thandler.changeFlags(opts, hints);\n\t\t\t\tbreak;\n\t\t\tcase 'spell':\n\t\t\t\thandler.damage(opts, hints);\n\t\t\t\tawait handler.saves(opts, hints);\n\t\t\t\tawait handler.spell(opts, hints);\n\t\t\t\tbreak;\n\t\t\tcase 'consumable':\n\t\t\tcase 'equipment':\n\t\t\tcase 'loot':\n\t\t\tcase 'weapon':\n\t\t\t\thandler.proficiency(opts, hints);\n\t\t\t\thandler.damage(opts, hints);\n\t\t\t\thandler.attack(opts, hints);\n\t\t\t\thandler.item(opts, hints);\n\t\t\t\thandler.changes(opts, hints);\n\t\t\t\thandler.changeFlags(opts, hints);\n\t\t\t\tawait handler.saves(opts, hints);\n\t\t\t\tbreak;\n\t\t\tcase 'attack':\n\t\t\t\thandler.proficiency(opts, hints);\n\t\t\t\thandler.damage(opts, hints);\n\t\t\t\thandler.attack(opts, hints);\n\t\t\t\thandler.item(opts, hints);\n\t\t\t\tawait handler.saves(opts, hints);\n\t\t\t\tbreak;\n\t\t\tcase 'buff':\n\t\t\t\thandler.changes(opts, hints);\n\t\t\t\thandler.changeFlags(opts, hints);\n\t\t\t\tbreak;\n\t\t\tcase 'class':\n\t\t\t\thandler.class(opts, hints);\n\t\t\t\thandler.changes(opts, hints);\n\t\t\t\thandler.changeFlags(opts, hints);\n\t\t\t\tbreak;\n\t\t\t// case 'race':\n\t\t\tcase 'container':\n\t\t\t\thandler.container(opts, hints);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\t// NOP\n\t\t\t\tbreak;\n\t\t}\n\t\thandler.action(opts, hints);\n\t\thandler.value(opts, hints, context.isContainer);\n\t\thandler.scripts(opts, hints);\n\t\tawait handler.customHints(opts, hints);\n\n\t\tfor (const itemHandler of itemHandlers) {\n\t\t\titemHandler(opts, hints);\n\t\t}\n\n\t\tconst actor = context.actor;\n\n\t\tlet handlerErrors = 0;\n\t\tfor (const exItemHandler of exItemHandlers) {\n\t\t\tlet error = false;\n\t\t\ttry {\n\t\t\t\tconst exHints = exItemHandler(actor, item, opts) ?? [];\n\t\t\t\tfor (const xh of exHints) {\n\t\t\t\t\tif (xh instanceof Hint) hints.append(xh.element(opts.iconize));\n\t\t\t\t\telse {\n\t\t\t\t\t\tconsole.error('ITEM HINTS | Bad return value', xh, 'from external handler:', exItemHandler, 'for', item.name, item);\n\t\t\t\t\t\terror = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\tconsole.error('ITEM HINTS | Error in external handler:\\n', { actor, item, uuid: item.uuid, handler: exItemHandler }, '\\n', err, '\\nHANDLER REMOVED!');\n\t\t\t\terror = true;\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tif (error) {\n\t\t\t\t\thandlerErrors++;\n\t\t\t\t\texItemHandler.__ih_needsDelete = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (handlerErrors) {\n\t\t\tfor (let i = 0; i < exItemHandlers.length; i++) {\n\t\t\t\tif (exItemHandlers[i].__ih_needsDelete) {\n\t\t\t\t\texItemHandlers.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcatch (err) {\n\t\tconsole.error('‚ö†Ô∏è ITEM HINTS | FAILURE | ITEM:', item?.name, { item, element: context.html }, '\\n', err);\n\t}\n\n\treturn hints;\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport function handleAction(o, hints) {\n\tconst item = o.item;\n\tif (!['attack', 'weapon', 'spell'].includes(item.type)) return;\n\n\tconst itemData = o.itemData;\n\n\tif (itemData.actions !== undefined && !item.hasAction)\n\t\thints.append(Hint.create(i18n.get('Koboldworks.Generic.NoAction'), ['warning', 'no-action']).element());\n\n\tif (itemData.actions?.some(a => a.usesAmmo && !a.ammoType))\n\t\thints.append(Hint.create(i18n.get('Koboldworks.Generic.NoAmmoType'), ['warning', 'no-ammo-type']).element());\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport function handleAttack(o, hints) {\n\tconst itemData = o.itemData;\n\tconst fa = o.defaultAction;\n\tif (!fa) return;\n\n\tif (itemData.subType === 'natural') {\n\t\tif (!fa?.naturalAttack?.primary)\n\t\t\thints.append(Hint.create(i18n.get('Koboldworks.Generic.Secondary'), ['natural', 'secondary']).element());\n\t}\n\n\tif (['mcman', 'rcman'].includes(fa.actionType)) {\n\t\thints.append(Hint.create(i18n.get('PF1.CMBAbbr'), ['combat-maneuver']).element());\n\t}\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport function handleDamage(o, hints) {\n\tconst item = o.item;\n\tif (!item.hasDamage) return;\n\n\tif (o.itemData.nonlethal) {\n\t\thints.append(\n\t\t\tHint.create(\n\t\t\t\ti18n.get('Koboldworks.Generic.Nonlethal'),\n\t\t\t\t['nonlethal'],\n\t\t\t\t{ icon: 'far fa-hand-peace' },\n\t\t\t).element(o.iconize),\n\t\t);\n\t}\n}\n",
    "// Change Flags\n\nimport { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} opt Options\n * @param hints\n */\nexport function handleChangeFlags(opt, hints) {\n\tif (!opt.changes) return;\n\tif (!opt.isIdentified) return;\n\tconst flags = opt.itemData.changeFlags;\n\tif (!flags) return;\n\tif (flags.heavyArmorFullSpeed && flags.mediumArmorFullSpeed) hints.append(Hint.create('+ArmorSpd', ['change']).element());\n\telse if (flags.heavyArmorFullSpeed) hints.append(Hint.create('+ArmorSpd (Hvy)', ['change']).element());\n\telse if (flags.mediumArmorFullSpeed) hints.append(Hint.create('+ArmorSpd (Med)', ['change']).element());\n\tif (flags.loseDexToAC) hints.append(Hint.create(`-${i18n.get('Koboldworks.Short.DexterityToAC')}`, ['change', 'penalty']).element());\n\tif (flags.noEncumbrance) hints.append(Hint.create(`-${i18n.get('PF1.Encumbrance')}`, ['change']).element());\n}\n",
    "// Changes\n// TODO: Rewrite this mess. It's impossible to follow what it's doing.\n\nimport { CFG } from '../config.mjs';\nimport { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\nimport { UniformObject } from '@root/components/uniform-object.mjs';\n\n/**\n * Remove flairs, remove excessive spacing, simplify math\n *\n * @param {string} formula\n * @returns {string}\n */\nexport const stripFlair = (formula) => formula\n\t.replace(/\\[.*?]/g, '').replace(/\\s{2,}/g, ' ').replace(/\\+ -/g, '-');\n\n/**\n * @param {string} formula\n * @param {object} rollData\n * @returns {number}\n */\nfunction staticRoll(formula, rollData) {\n\t/* global RollPF */\n\tconst f = new RollPF(formula, rollData).evaluateSync({ minimize: true });\n\treturn f.total;\n}\n\nclass ChangeLabel {\n\tlabel;\n\toptional;\n\tsymbolic;\n\tconstructor(label, { optional = true, symbolic = true } = {}) {\n\t\tthis.label = label;\n\t\tthis.optional = optional;\n\t\tthis.symbolic = symbolic;\n\t}\n}\n\nconst OPTIONAL_CATEGORIES = new Set(['senses', 'defense']);\n\n/**\n * @param {string} k\n * @param {import('../handler-options.mjs').HandlerOptions} o Options\n * @param {boolean} isChange\n * @returns {ChangeLabel}\n */\nfunction generateChangeLabel(k, o, isChange) {\n\tswitch (k) {\n\t\tcase 'str': case 'con': case 'dex':\n\t\tcase 'int': case 'cha': case 'wis':\n\t\tcase 'ability':\n\t\tcase 'strChecks': case 'dexChecks': case 'conChecks':\n\t\tcase 'wisChecks': case 'intChecks': case 'chaChecks':\n\t\tcase 'abilityChecks': return new ChangeLabel(i18n.get('Koboldworks.Short.Ability'));\n\t\tcase 'attack':\n\t\tcase 'attacks': return new ChangeLabel(i18n.get('Koboldworks.Short.Attack'), { optional: false });\n\t\tcase 'damage': return new ChangeLabel(i18n.get('Koboldworks.Short.Damage'), { optional: false });\n\t\tcase 'allSavingThrows':\n\t\tcase 'ref':\n\t\tcase 'will':\n\t\tcase 'fort':\n\t\tcase 'savingThrows': return new ChangeLabel(i18n.get('Koboldworks.Short.SavingThrow'));\n\t\tcase 'skill':\n\t\tcase 'reach':\n\t\tcase 'skills': return new ChangeLabel(i18n.get('Koboldworks.Short.Skill'));\n\t\tcase 'speed': return new ChangeLabel(i18n.get('Koboldworks.Short.Speed'), { optional: false });\n\t\tcase 'spell': return new ChangeLabel(i18n.get('Koboldworks.Short.Spell'));\n\t\tcase 'size':\n\t\tcase 'bonusFeats':\n\t\tcase 'init':\n\t\tcase 'carryStr':\n\t\tcase 'carryMult':\n\t\tcase 'misc': return new ChangeLabel(i18n.get('Koboldworks.Short.Misc'), { optional: true });\n\t\tcase 'health': return new ChangeLabel(i18n.get('Koboldworks.Short.Health'));\n\t\tcase 'ac':// throw new Error('AC should be mapped to defense'); // outdated?\n\t\tcase 'cmd':// throw new Error('CMD should be mapped to defense');\n\t\tcase 'defense': return new ChangeLabel(i18n.get('Koboldworks.Short.Defense'));\n\t\tcase 'dc': return new ChangeLabel(i18n.get('Koboldworks.Short.SpellDC'));\n\t\tdefault:\n\t\t\ttry {\n\t\t\t\tconst t = isChange ? pf1.config.buffTargets[k] : pf1.config.contextNoteTargets[k];\n\t\t\t\tif (t) {\n\t\t\t\t\tconst optional = OPTIONAL_CATEGORIES.has(t.category);\n\t\t\t\t\treturn new ChangeLabel(pf1.config.buffTargetCategories[t.category]?.label, { optional });\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// What are these?\n\t\t\t\t\tconst cat = pf1.config.buffTargetCategories[k];\n\t\t\t\t\tif (cat !== undefined) return new ChangeLabel(cat?.label, { optional: false });\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (err) {\n\t\t\t\tconsole.log('‚ö†Ô∏è ITEM HINTS | Unrecognized key:', k, 'in', o.item.name, err);\n\t\t\t\treturn new ChangeLabel(i18n.get('Koboldworks.Generic.BadSource'), { optional: false, symbolic: false });\n\t\t\t}\n\t}\n\n\treturn new ChangeLabel(i18n.get('Koboldworks.Generic.UnknownSource'), { optional: false, symbolic: false });\n};\n\n/**\n * @param o\n * @param {object} obj - Collective object.\n * @param {pf1.components.ItemChange|pf1.components.ContextNote} ch - Current change\n * @returns\n */\nfunction createUniformObject(o, obj, ch) {\n\tconst isChange = ch instanceof pf1.components.ItemChange;\n\tconst change = isChange ? ch : null;\n\tconst contextNote = !isChange ? ch : null;\n\n\tconst { problems, commonTargets } = o;\n\n\tconst item = ch.parent;\n\tlet cto;\n\ttry {\n\t\tcto = new UniformObject(ch, o.actor, item);\n\n\t\t// Check for missing target\n\t\t// No longer needed\n\t\tif (!(cto.target?.length > 0)) {\n\t\t\tif (!('noTarget' in problems)) {\n\t\t\t\tconsole.log('‚ö†Ô∏è ITEM HINTS | Missing Target | Item:', item.name, '; Change:', ch, item);\n\t\t\t\tproblems['noTarget'] = {\n\t\t\t\t\tlabel: i18n.get('Koboldworks.Sanity.Change.TargetlessLabel'),\n\t\t\t\t\thint: i18n.get('Koboldworks.Sanity.Change.TargetlessHint'),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\n\t\t// Check for missing target\n\t\tif (cto.label === ch.target) {\n\t\t\tif (!('badTarget' in problems)) {\n\t\t\t\tconsole.log('‚ö†Ô∏è ITEM HINTS | Bad Target |', item.name, { item, change, contextNote });\n\t\t\t\tproblems['badTarget'] = {\n\t\t\t\t\tlabel: i18n.get('Koboldworks.Sanity.Change.BadTargetLabel'),\n\t\t\t\t\thint: i18n.get('Koboldworks.Sanity.Change.BadTargetHint', { target: ch.target }),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\n\t\t// Check for missing formula\n\t\tif (isChange && !(ch.formula?.length > 0)) {\n\t\t\tif (!('noFormula' in problems)) {\n\t\t\t\t// Change specific\n\t\t\t\tconsole.log('‚ö†Ô∏è ITEM HINTS | Missing Formula |', item.name, { item, change, contextNote });\n\n\t\t\t\tproblems['noFormula'] = {\n\t\t\t\t\tlabel: i18n.get('Koboldworks.Sanity.Change.FormulalessLabel'),\n\t\t\t\t\thint: i18n.get('Koboldworks.Sanity.Change.FormulalessHint'),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\n\t\t// Context note missing text\n\t\tif (!isChange && !(ch.text?.trim().length > 0)) {\n\t\t\tif (!('noText' in problems)) {\n\t\t\t\t// Context note specific\n\t\t\t\tconsole.log('‚ö†Ô∏è ITEM HINTS | Missing Text |', item.name, { item, change: ch });\n\t\t\t\tproblems['noText'] = {\n\t\t\t\t\tlabel: i18n.get('Koboldworks.Sanity.Change.TextlessLabel'),\n\t\t\t\t\thint: i18n.get('Koboldworks.Sanity.Change.TextlessHint', { target: ch.target }),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\n\t\t// Missing custom/sub skill\n\t\tif (cto.isSkill && !cto.skill) {\n\t\t\tif (!('badSkill' in problems)) {\n\t\t\t\tproblems['badSkill'] = {\n\t\t\t\t\tlabel: i18n.get('Koboldworks.Sanity.Change.MissingSkillLabel'),\n\t\t\t\t\thint: i18n.get('Koboldworks.Sanity.Change.MissingSkillHint', { skillId: cto._skillId }),\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn obj;\n\t\t}\n\n\t\t// Store UO\n\t\tconst category = cto.category;\n\t\tif (category) {\n\t\t\tobj[category] ??= {};\n\t\t\tobj[category][cto.target] ??= cto;\n\t\t\tcommonTargets[category] ??= {};\n\t\t\tcommonTargets[category][cto.target] ??= cto;\n\t\t\treturn obj;\n\t\t}\n\t\telse {\n\t\t\tconsole.error('ITEM HINTS | No Key', { obj, ch, item, cto });\n\t\t}\n\t}\n\tcatch (err) {\n\t\tconsole.error('ITEM HINTS | Error:', err, { change: ch, object: cto, item, uniform: obj });\n\t\treturn obj;\n\t}\n};\n\n/**\n * @param {import('../handler-options.mjs').HandlerOptions} o Options\n * @param {} hints\n */\nexport function handleChanges(o, hints) {\n\tif (!o.changes) return;\n\tif (!o.isIdentified) return;\n\n\tconst itemData = o.itemData;\n\tif (!(itemData.changes?.length > 0 || itemData.contextNotes?.length > 0)) return;\n\n\tconst commonTargets = {}, problems = {};\n\n\to.commonTargets = commonTargets;\n\to.problems = o;\n\n\t/**\n\t *\n\t * @param {*} list\n\t * @returns {Record<string, object>}\n\t */\n\tconst transformChanges = (list) => list?.reduce((obj, ch) => createUniformObject(o, obj, ch), {}) ?? {};\n\tconst ctargets = transformChanges(o.item.changes),\n\t\tntargets = transformChanges(itemData.contextNotes);\n\n\tconst maxLabelLength = game.settings.get(CFG.id, CFG.SETTING.maxLabelLength);\n\n\t/**\n\t * @param {string} key\n\t * @param {boolean} isChange\n\t * @returns {string}\n\t */\n\tfunction formatLabel(key, isChange = true) {\n\t\tconst ct = commonTargets[key],\n\t\t\tck = Object.keys(ct),\n\t\t\tb = new Set(ck.filter(x => ct[x].isChange === isChange).map(x => ct[x].label)),\n\t\t\tlb = generateChangeLabel(key, o, isChange),\n\t\t\tsym = lb.symbolic ? '¬±' : '';\n\n\t\tif (b.size === 0) return `${sym}${lb.label}`;\n\n\t\tconst label = [sym];\n\t\tlet subLabel;\n\t\tif (lb.optional) {\n\t\t\tsubLabel = [...b].join(';');\n\t\t}\n\t\telse {\n\t\t\tlabel.push(lb.label, ':');\n\t\t\tsubLabel = [...b].join(',');\n\t\t}\n\n\t\tif (subLabel?.length > maxLabelLength) subLabel = i18n.get('Koboldworks.Hints.Many');\n\t\tlabel.push(subLabel);\n\t\treturn label.join('');\n\t};\n\n\tfunction makeChangeHint(key) {\n\t\t// Changes & Notes\n\t\tconst cC = [];\n\t\tlet cN = [];\n\n\t\tfor (const x of Object.keys(commonTargets[key])) {\n\t\t\tif (ctargets[key]?.[x]) {\n\t\t\t\tconst cto = ctargets[key][x];\n\t\t\t\tif (!cto.isChange) continue;\n\t\t\t\tlet total;\n\t\t\t\ttry {\n\t\t\t\t\t/* global RollPF */\n\t\t\t\t\tconst f = new RollPF(cto.change.formula, o.rollData).evaluateSync({ minimize: true });\n\t\t\t\t\ttotal = f.total;\n\t\t\t\t}\n\t\t\t\tcatch {\n\t\t\t\t\t/* ignore */\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst label = [cto.label, ' = ', total !== undefined ? `~${total}` : cto.change.formula];\n\t\t\t\tcC.push(label.join(''));\n\t\t\t}\n\t\t\tif (ntargets[key]?.[x]) {\n\t\t\t\tconst cto = ntargets[key][x];\n\t\t\t\tif (cto.isChange) continue;\n\t\t\t\tcN.push(cto.label);\n\t\t\t}\n\t\t}\n\n\t\tlet changeHint, noteHint;\n\t\tif (cC.length > 0) {\n\t\t\tconst title = i18n.get(cC.length == 1 ? 'PF1.Change' : 'PF1.Changes') + ': ';\n\t\t\tcC.unshift(title);\n\t\t\tconst sep = cC.length == 2 ? '' : '\\n';\n\t\t\tchangeHint = Hint.create(formatLabel(key, true), ['change'], { hint: cC.join(sep) });\n\t\t}\n\t\tif (cN.length > 0) {\n\t\t\tconst title = i18n.get(cN.length == 1 ? 'Koboldworks.Hints.Contextual' : 'PF1.ContextNotes') + ': ';\n\t\t\tcN = [...new Set(cN)]; // Ensure notes are unique\n\t\t\tcN.unshift(title);\n\t\t\tconst sep = cN.length == 2 ? '' : '\\n';\n\t\t\tnoteHint = Hint.create(formatLabel(key, false), ['contextual'], { hint: cN.join(sep) });\n\t\t}\n\n\t\treturn [changeHint, noteHint];\n\t};\n\n\tfor (const ch of Object.keys(commonTargets)) {\n\t\tconst [changes, notes] = makeChangeHint(ch);\n\t\tif (changes) hints.append(changes.element());\n\t\tif (notes) hints.append(notes.element());\n\t}\n\n\tfor (const problem of Object.values(problems)) {\n\t\thints.prepend(Hint.create(problem.label, ['change', 'error'], { hint: problem.hint }).element());\n\t}\n}\n",
    "import { CFG } from '@root/config.mjs';\nimport { i18n } from '@root/i18n.mjs';\n\n// Alter default translations to be shorter\nconst coreLang = /** @type {const}} */ ({\n\tbab: 'PF1.BABAbbr',\n\t// ac: 'PF1.BuffTarAC', // Generic AC -> AC\n\tflySpeed: 'PF1.Movement.Mode.fly',\n\tburrowSpeed: 'PF1.Movement.Mode.burrow',\n\tlandSpeed: 'PF1.Movement.Mode.land',\n\tclimbSpeed: 'PF1.Movement.Mode.climb',\n\tswimSpeed: 'PF1.Movement.Mode.swim',\n\twdamage: CONFIG.Item.typeLabels.weapon,\n\tsdamage: CONFIG.Item.typeLabels.spell,\n\tcmb: 'PF1.CMBAbbr',\n\tcmd: 'PF1.CMDAbbr',\n\tallSpeeds: 'PF1.All',\n\tattack: 'PF1.All',\n\tmattack: 'PF1.Melee',\n\trattack: 'PF1.Ranged',\n\tdamage: 'PF1.All',\n\tspellEffect: 'TYPES.Item.spell',\n\tallSavingThrows: 'Koboldworks.Short.AllSaves',\n\tmhp: 'PF1.HPShort',\n\tstr: 'PF1.AbilityShortStr',\n\tdex: 'PF1.AbilityShortDex',\n\tcon: 'PF1.AbilityShortCon',\n\tint: 'PF1.AbilityShortInt',\n\twis: 'PF1.AbilityShortWis',\n\tcha: 'PF1.AbilityShortCha',\n\tmwdamage: 'Koboldworks.Short.MeleeWeapon',\n\trwdamage: 'Koboldworks.Short.RangedWeapon',\n\ttwdamage: 'Koboldworks.Short.ThrownWeapon',\n\tmdamage: 'Koboldworks.Short.Melee',\n\trdamage: 'Koboldworks.Short.Ranged',\n\tndamage: 'Koboldworks.Short.Natural',\n\tstrMod: 'Koboldworks.Short.StrMod',\n\tdexMod: 'Koboldworks.Short.DexMod',\n\tconMod: 'Koboldworks.Short.ConMod',\n\tintMod: 'Koboldworks.Short.IntMod',\n\twisMod: 'Koboldworks.Short.WisMod',\n\tchaMod: 'Koboldworks.Short.ChaMod',\n\tbonusSkillRanks: 'Koboldworks.Short.SkillRanks',\n\tcarryMult: 'Koboldworks.Short.CarryMult',\n});\n\n// Add extensions\nconst moduleLangExtensions = /** @type {const}} */ ({\n\tnac: 'Koboldworks.Short.NaturalAC',\n\ttac: 'Koboldworks.Short.TouchAC',\n\tmDexA: 'Koboldworks.Short.ArmorMaxDex',\n\tmDexS: 'Koboldworks.Short.ShieldMaxDex',\n\tffac: 'Koboldworks.Short.FlatfootedAC',\n\tffcmd: 'Koboldworks.Short.FlatfootedCMD',\n\tspellResist: 'Koboldworks.Short.SpellResistance',\n\tallChecks: 'Koboldworks.Short.AllAblChecks',\n\t// Ability score stuff\n\tstrSkills: 'Koboldworks.Short.StrSkills',\n\tdexSkills: 'Koboldworks.Short.DexSkills',\n\tconSkills: 'Koboldworks.Short.ConSkills',\n\tintSkills: 'Koboldworks.Short.IntSkills',\n\twisSkills: 'Koboldworks.Short.WisSkills',\n\tchaSkills: 'Koboldworks.Short.ChaSkills',\n\tstrChecks: 'Koboldworks.Short.StrChecks',\n\tdexChecks: 'Koboldworks.Short.DexChecks',\n\tconChecks: 'Koboldworks.Short.ConChecks',\n\tintChecks: 'Koboldworks.Short.IntChecks',\n\twisChecks: 'Koboldworks.Short.WisChecks',\n\tchaChecks: 'Koboldworks.Short.ChaChecks',\n\ttattack: 'Koboldworks.Short.Thrown',\n\ttdamage: 'Koboldworks.Short.Thrown',\n\tinit: 'Koboldworks.Short.Initiative',\n\tref: 'Koboldworks.Short.Reflex',\n\tfort: 'Koboldworks.Short.Fortitude',\n\twill: 'Koboldworks.Short.Will',\n});\n\nconst disableUnlang = () => game.i18n.lang !== 'en' && !game.settings.get(CFG.id, CFG.SETTING.unlang);\n\n// Combine\nlet simplifications = {};\nHooks.once('init', () => simplifications = Object.assign({}, coreLang, disableUnlang() ? {} : moduleLangExtensions));\n\n/**\n * @class\n */\nexport class UniformObject {\n\t/** @type {string} */\n\ttarget;\n\t/** @type {string[]} */\n\tparts;\n\t/** @type {boolean} */\n\tisChange;\n\t/** @type {string} */\n\tformula;\n\n\tconstructor(ch, actor = null, item = null) {\n\t\tthis.target = ch.target;\n\t\tthis.isChange = ch instanceof pf1.components.ItemChange;\n\t\tthis.formula = ch.formula;\n\n\t\tthis.#change = new WeakRef(ch);\n\t\tthis.#actor = new WeakRef(actor);\n\t\tthis.#item = new WeakRef(item);\n\n\t\tthis.parts = ch.target?.split('.') ?? [];\n\t}\n\n\t/** @type {WeakRef<ItemChange>} */\n\t#change;\n\tget change() {\n\t\treturn this.#change.deref();\n\t}\n\n\t/** @type {WeakRef<ActorPF>} */\n\t#actor;\n\tget actor() {\n\t\treturn this.#actor?.deref();\n\t}\n\n\t/** @type {WeakRef<ItemPF>} */\n\t#item;\n\tget item() {\n\t\treturn this.#item.deref();\n\t}\n\n\t#source;\n\tget source() {\n\t\tif (!this.#source) {\n\t\t\tconst sources = this.isChange ? pf1.config.buffTargets : pf1.config.contextNoteTargets;\n\t\t\tthis.#source = sources[this.target];\n\t\t\tif (!this.#source) {\n\t\t\t\tif (this.isSkill) this.#source = sources.skills;\n\t\t\t\telse if (this.isConcentration) this.#source = sources.concentration;\n\t\t\t\telse if (this.isCL) this.#source = sources.cl;\n\t\t\t\telse if (this.isSpellDC) this.#source = sources.dc;\n\t\t\t\telse console.error('No Source', this);\n\t\t\t}\n\t\t}\n\t\treturn this.#source;\n\t}\n\n\t/** @type {boolean} */\n\tget isCL() {\n\t\treturn this.parts[0] === 'cl';\n\t}\n\n\t/** @type {boolean} */\n\tget isSpellDC() { return this.parts[0] === 'dc'; }\n\n\t/** @type {boolean} */\n\tget isConcentration() { return this.parts[0] === 'concn' || this.target === 'concentration'; }\n\n\tstatic SPELL_TARGETS = new Set(['cl', 'concn', 'concentration']);\n\tget isSpell() {\n\t\tconst cat = this.parts[0];\n\t\treturn this.constructor.SPELL_TARGETS.has(cat);\n\t}\n\n\t/** @type {boolean} */\n\tget isSkill() { return this.parts[0] === 'skill'; }\n\n\t#category;\n\t/** @type {string} */\n\tget category() {\n\t\tif (!this.#category) {\n\t\t\tthis.#category = this.source?.category;\n\t\t\tif (this.isSkill) return this.#category = 'skill';\n\n\t\t\t// Special case to avoid concentration category\n\t\t\tif (this.isConcentration) return this.#category = 'spell';\n\t\t\tif (this.isSpell) return this.#category = 'spell';\n\n\t\t\tconst [cat] = this.parts;\n\t\t\tif (this.isChange) {\n\t\t\t\tif (cat in pf1.config.buffTargets) return this.#category = cat;\n\t\t\t}\n\t\t\telse if (cat in pf1.config.contextNoteTargets) return this.#category = cat;\n\n\t\t\tif (!this.#category) console.error('ITEM HINTS | No Category', this);\n\t\t}\n\t\treturn this.#category;\n\t}\n\n\t#skill;\n\t_skillId;\n\tget skill() {\n\t\tif (this.isSkill && this.#skill === undefined) {\n\t\t\tthis._skillId ??= this.target.slice(6);\n\t\t\ttry {\n\t\t\t\tthis.#skill = this.actor.getSkillInfo(this._skillId);\n\t\t\t}\n\t\t\tcatch {\n\t\t\t\t// Ignore\n\t\t\t\tthis.#skill = null;\n\t\t\t}\n\t\t}\n\t\treturn this.#skill;\n\t}\n\n\t#label;\n\tget label() {\n\t\tthis.#label ??= this._generateLabel();\n\t\treturn this.#label;\n\t}\n\n\t_generateLabel() {\n\t\tif (this.isSkill) return this.#skill?.name;\n\t\tif (this.isCL) return i18n.get('PF1.CasterLevelAbbr');\n\t\tif (this.isConcentration) return i18n.get('Koboldworks.Missing.PF1.ConcentrationAbbr');\n\t\tif (this.isSpellDC) return i18n.get('PF1.SpellDC');\n\t\tif (this.target in simplifications) return i18n.get(simplifications[this.target]);\n\t\treturn (this.isChange ? pf1.config.buffTargets : pf1.config.contextNoteTargets)[this.target]?.label ?? this.target;\n\t}\n}\n",
    "// Class\n\nimport { Hint } from '../hint.mjs';\nimport { descriptorIcons } from '../common.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport function handleClass(o, hints) {\n\tconst itemData = o.itemData,\n\t\thp = itemData.fc.hp.value,\n\t\tskill = itemData.fc.skill.value,\n\t\talt = itemData.fc.alt.value;\n\tif (hp > 0) hints.append(Hint.create(`${i18n.get('PF1.FavouredClassBonus.HP')} √ó${hp}`, ['fcb', 'hp']).element());\n\tif (skill > 0) hints.append(Hint.create(`${i18n.get('PF1.FavouredClassBonus.Skill')} √ó${skill}`, ['fcb', 'skill']).element());\n\tif (alt > 0) hints.append(Hint.create(`${i18n.get('PF1.FavouredClassBonus.Alt')} √ó${alt}`, ['fcb', 'alt']).element());\n\n\tif (o.sanity) {\n\t\tconst total = hp + skill + alt;\n\t\tif (total > 0 && itemData.level !== total) {\n\t\t\tconst shint = descriptorIcons.inconsistency.clone();\n\t\t\tshint.hint = i18n.get('Koboldworks.Sanity.FCBInequal', { diff: total - itemData.level });\n\t\t\tshint.additionalClasses.push('fcb');\n\t\t\thints.append(shint.element(true));\n\t\t}\n\t}\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\nexport function handleContainer(o, hints) {\n\tconst item = o.item,\n\t\tcount = item.items.contents.length,\n\t\tsubItems = item.items.find(i => i.type === 'container'),\n\t\tcoins = o.itemData.currency ?? {},\n\t\thaveCoins = coins.pp > 0 || coins.gp > 0 || coins.sp > 0 || coins.cp > 0,\n\t\tmore = subItems || haveCoins;\n\n\tconst label = more ? i18n.get('Koboldworks.Hints.ContentsIndefinite', { quantity: count }) : i18n.get('Koboldworks.Hints.Contents', { quantity: count });\n\n\tconst h = [label];\n\tif (subItems) h.push(i18n.get('PF1.InventoryContainers'));\n\tif (haveCoins) h.push(i18n.get('PF1.Currency.Label'));\n\n\thints.append(Hint.create(label, ['item-count'], { hint: h.join(' + ') }).element());\n}\n",
    "/*\n * Combined handler for many item specific details.\n *\n * - Broken\n * - Masterwork\n * - Too low item CL\n * - Size\n * - Enhancement bonus\n * - Aura\n */\n\nimport { CFG } from '../config.mjs';\nimport { Hint } from '../hint.mjs';\nimport { descriptorIcons } from '../common.mjs';\nimport { i18n } from '../i18n.mjs';\n\nconst descriptors = {\n\tmasterwork: new Hint('PF1.Masterwork', ['masterwork'], { icon: 'fa-solid fa-gem' }),\n\tbroken: new Hint('PF1.Broken', ['broken'], { icon: 'fa-solid fa-heart-broken' }),\n\tunidentified: new Hint('PF1.Unidentified', ['unidentified'], { icon: 'fa-solid fa-eye-slash' }),\n};\n\nHooks.once('ready', () => {\n\tfor (const value of Object.values(descriptors))\n\t\tvalue.label = i18n.get(value.label);\n});\n\nconst sizeMap = { fine: 0, dim: 1, tiny: 2, sm: 3, med: 4, lg: 5, huge: 6, grg: 7, col: 8 };\nconst sizeMapInvert = foundry.utils.invertObject(sizeMap);\n\nconst auraIconsGI = {\n\tabj: 'img/game-icons/magic-shield.svg',\n\tcon: 'img/game-icons/portal.svg',\n\tdiv: 'img/game-icons/crystal-ball.svg',\n\tenc: 'img/game-icons/brain-tentacle.svg',\n\tevo: 'img/game-icons/energy-arrow.svg',\n\till: 'img/game-icons/magic-trick.svg',\n\tnec: 'img/game-icons/death-juice.svg',\n\ttrs: 'img/game-icons/frog-prince.svg',\n\tuni: 'img/game-icons/sparkles.svg',\n};\n\nconst auraIconsTh = {\n\tabj: 'img/thassilonian/envy.svg',\n\tcon: 'img/thassilonian/sloth.svg',\n\tdiv: 'img/thassilonian/truth.svg',\n\tenc: 'img/thassilonian/lust.svg',\n\tevo: 'img/thassilonian/wrath.svg',\n\till: 'img/thassilonian/pride.svg',\n\tnec: 'img/thassilonian/gluttony.svg',\n\ttrs: 'img/thassilonian/greed.svg',\n\tuni: 'img/thassilonian/diligence.svg',\n};\n\nconst auraColors = {\n\tabj: 'green',\n\tcon: 'blue',\n\tdiv: '??',\n\tenc: 'red',\n\tevo: 'orange',\n\till: 'violet',\n\tnec: 'indigo',\n\ttrs: 'yellow',\n\tuni: '??',\n};\n\nfunction getAuraIcon(school, type) {\n\tconst a = type === 'runes' ? auraIconsTh : auraIconsGI;\n\treturn `modules/${CFG.id}/${a[school] ?? a.uni}`;\n}\n\n/**\n * @param {import('../handler-options.mjs').HandlerOptions} o Options\n * @param hints\n */\nexport function handleItem(o, hints) {\n\tconst item = o.item;\n\n\tconst itemData = o.itemData;\n\n\tif (!o.homebrew && o.sanity && o.showSecrets && o.casterLevel > 0 && o.enhancement > 0) {\n\t\tconst clDiff = o.casterLevel - o.enhancement * 3;\n\t\t// Celestial Armor is core item that defies this base logic\n\t\tif (clDiff < 0) { // higher CL is possible, lower is odd\n\t\t\tconst underLevel = descriptorIcons.inconsistency.clone();\n\t\t\tunderLevel.hint = i18n.get('Koboldworks.Sanity.InsufficientCL', { diff: clDiff });\n\t\t\thints.append(underLevel.element(true));\n\t\t}\n\t}\n\n\tconst { value: currentHp, max: maxHp } = itemData.hp ?? {};\n\tif (itemData.broken) {\n\t\tconst h = descriptors.broken.clone();\n\t\tif (maxHp > 0) h.hint = `${h.label}<br>${currentHp}/${maxHp} HP`;\n\t\thints.append(h.element(o.iconize));\n\t}\n\telse if (currentHp < maxHp) {\n\t\tconst h = new Hint(`${currentHp}/${maxHp} HP`, ['damaged'], { icon: 'fa-solid fa-heart-pulse' });\n\t\thints.append(h.element(o.iconize));\n\t}\n\n\tif (itemData.masterwork && !(o.enhancement > 0 && o.showSecrets))\n\t\thints.append(descriptors.masterwork.clone().element(o.iconize));\n\n\tif (o.showSecrets) {\n\t\tif (o.enhancement > 0)\n\t\t\thints.append(Hint.create(`+${o.enhancement}`, ['enhancement'], { hint: i18n.get('Koboldworks.Hints.Enhancement', { enh: o.enhancement }) }).element());\n\n\t\tif (!o.isIdentified) hints.append(descriptors.unidentified.clone().element(o.iconize));\n\n\t\tif (o.casterLevel > 0 && o.showSecrets) {\n\t\t\tif (game.settings.get(CFG.id, CFG.SETTING.aura)) {\n\t\t\t\tconst auraKey = itemData.aura.school,\n\t\t\t\t\taura = itemData.aura.custom ? auraKey : pf1.config.spellSchools[auraKey];\n\n\t\t\t\tconst hint = Hint.create(`${aura} (${o.casterLevel})`, ['aura']);\n\t\t\t\tconst auraD = game.settings.get(CFG.id, CFG.SETTING.schoolAura);\n\t\t\t\tconst asKeys = ['letters', 'letterswcl'].includes(auraD);\n\t\t\t\tif (o.iconize) {\n\t\t\t\t\tif (asKeys) {\n\t\t\t\t\t\thint.hint = hint.label;\n\t\t\t\t\t\thint.label = auraKey.length <= 3 ? i18n.get(`Koboldworks.School.${auraKey || 'Unknown'}`) : i18n.get('Koboldworks.School.odd');\n\t\t\t\t\t\tif (auraD === 'letterswcl') hint.label += ` (${o.casterLevel})`;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\thint.image = getAuraIcon(auraKey, auraD);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\thints.append(hint.element(!asKeys ? o.iconize : false));\n\t\t\t}\n\n\t\t\t// Add glowing label (faint, moderate, strong)\n\t\t\tconst glowLevel = Math.clamp(Math.ceil((o.casterLevel + 1) / 6), 1, 3); // 1-3\n\n\t\t\tif (!o.simulation && o.glow) {\n\t\t\t\to.element.querySelector('.item-name h4').classList.add(`enhancement-${glowLevel}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (!itemData.resizing) {\n\t\tif (!['loot', 'attack', 'consumable'].includes(item.type)) {\n\t\t\tconst itemSize = sizeMap[itemData.size || 'med'];\n\t\t\tconst actorSize = o.actorData?.traits?.size?.value;\n\t\t\tif (itemSize && actorSize !== itemSize) {\n\t\t\t\t// const size = Number.isFinite(sizeString) ? sizeString : sizeMap[sizeString];\n\t\t\t\tconst sizeLabel = pf1.config.actorSizes[sizeMapInvert[itemSize]];\n\t\t\t\thints.append(Hint.create(sizeLabel.capitalize(), ['size']).element());\n\t\t\t}\n\t\t}\n\t}\n}\n",
    "import { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o\n * @param {Hint[]} hints\n */\nexport function handleProficiency(o, hints) {\n\tconst actor = o.actor;\n\tif (!actor) return;\n\n\tconst item = o.item;\n\tif (!['equipment', 'attack', 'weapon', 'equipment'].includes(item.type)) return;\n\tif (item.type === 'equipment' && !['armor', 'shield'].includes(item.subType)) return;\n\n\tif (item.type === 'attack' && item.subType !== 'weapon') return; // Non-weapons have no proficiency\n\n\tlet proficient = true;\n\ttry {\n\t\tif (item.type === 'equipment') proficient = actor.hasArmorProficiency(item);\n\t\telse {\n\t\t\tconst override = item.type === 'attack'; // Attacks are sad little things still\n\t\t\tproficient = actor.hasWeaponProficiency(item, { override });\n\t\t}\n\t}\n\tcatch {\n\t\t// Proficiency not supported\n\t\treturn;\n\t}\n\n\tif (proficient) return;\n\n\tconst cssClasses = ['nonproficient'];\n\tconst forced = item.system.proficient ?? false;\n\tif (forced) cssClasses.push('forced-proficiency');\n\n\thints.append(Hint.create(\n\t\tforced ? i18n.get('Koboldworks.Missing.PF1.ForcedProficiency') : i18n.get('Koboldworks.Missing.PF1.Nonproficient'),\n\t\tcssClasses,\n\t\t{ icon: 'fa-solid fa-book-dead' },\n\t).element(o.iconize));\n}\n",
    "// Feats and spells\n\nimport { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport async function handleSaves(o, hints) {\n\tconst item = o.item;\n\tif (!item.hasSave) return;\n\n\tconst itemData = o.itemData,\n\t\titemFormula = itemData.save.dc,\n\t\tbookFormula = item.spellbook?.baseDCFormula ?? '',\n\t\tdcFormula = [bookFormula, itemFormula].map(f => f?.trim()).filter(f => !!f).join(' + ');\n\n\tconst rollData = o.rollData;\n\n\tif (dcFormula) {\n\t\t/* global RollPF */\n\t\tconst idc = RollPF.safeRoll(itemFormula, rollData);\n\t\tif (item.type !== 'spell' || idc.total !== 0) {\n\t\t\tconst rd = RollPF.safeRoll(dcFormula, rollData);\n\t\t\t// const dc = item.getDC(o.rollData);\n\t\t\tconst dc = !rd.err ? rd.total : 'Error';\n\t\t\tconst dcHint = Hint.create(`${i18n.get('PF1.DC')} ${dc}`, ['dc'], { hint: rd.formula });\n\t\t\thints.append(dcHint.element(o.iconize));\n\t\t}\n\t}\n\n\t// Save description\n\tconst save = itemData.save?.description;\n\tif (save?.length && !/harmless/i.test(save))\n\t\thints.append(Hint.create(await pf1.utils.enrichHTMLUnrolled(save, { rollData }), ['save']).element());\n}\n",
    "import { CFG } from '../config.mjs';\nimport { createNode, descriptorIcons } from '../common.mjs';\nimport { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {import(\"../handler-options.mjs\").HandlerOptions} o Options\n * @param {Element} hints hints element\n */\nexport async function handleSpell(o, hints) {\n\tconst itemData = o.itemData,\n\t\tmaterials = itemData.materials,\n\t\tmaterial = materials.value;\n\n\tconst nEl = Array.from(o.element.getElementsByClassName('spell-components')).at(-1);\n\t// Materials use special hint\n\tif (material && materials.gpValue > 0 && nEl) {\n\t\tconst mCost = descriptorIcons.material.clone();\n\t\tconst mHints = createNode('div', null, [CFG.CSS.branding, CFG.CSS.common]);\n\t\tmHints.append(mCost.element(true));\n\t\tnEl.append(mHints);\n\t}\n\n\tconst atWill = itemData.atWill ?? false;\n\n\tconst spellbook = o.item.spellbook ?? {};\n\n\tconst isBasicPrepared = spellbook.spellPreparationMode === 'prepared';\n\t// const preparedCaster = isBasicPrepared || spellbook.spellPreparationMode === 'hybrid';\n\t// const spellIsPrepared = (itemData.preparation?.value || 0) > 0;\n\n\tconst usesSpellpoints = spellbook.spellPoints?.useSystem ?? false;\n\n\t/** @type {pf1.components.ItemAction} */\n\tconst action = o.item.defaultAction;\n\tconst actionCost = !atWill ? await action?.getChargeCost({ interactive: false, maximize: true }) : 0,\n\t\tcastCost = !atWill ? (actionCost?.total ?? 0) : 0;\n\n\tif (atWill || castCost == 0) {\n\t\tconst label = i18n.get('Koboldworks.ItemHint.Description.Slotless'),\n\t\t\thint = !usesSpellpoints ? i18n.get('Koboldworks.ItemHint.Description.SlotlessHint') : i18n.get('Koboldworks.ItemHint.Description.SpellpointlessHint');\n\t\tconst slHint = Hint.create(label, ['slotcost', 'free'], { icon: 'fa-solid fa-infinity', hint });\n\t\thints.append(slHint.element(o.iconize));\n\t}\n\telse if (usesSpellpoints) {\n\t\tconst slHint = Hint.create(i18n.get('Koboldworks.ItemHint.Description.SpellpointCostShort', { cost: castCost, hint: i18n.get('Koboldworks.ItemHint.Description.SpellpointCost', { cost: castCost }) }), ['pointcost']);\n\t\thints.append(slHint.element(false));\n\t}\n\telse if (!isBasicPrepared && castCost > 1) {\n\t\tconst slHint = Hint.create(i18n.get('Koboldworks.ItemHint.Description.SlotCost', { cost: castCost }), ['castcost']);\n\t\thints.append(slHint.element(false));\n\t}\n\n\tif (!usesSpellpoints && isBasicPrepared) {\n\t\tconst slotCost = itemData.slotCost;\n\t\tif (slotCost > 1) {\n\t\t\tconst slHint = Hint.create(i18n.get('Koboldworks.ItemHint.Description.SlotCost', { cost: slotCost }), ['slotcost']);\n\t\t\thints.append(slHint.element(false));\n\t\t}\n\t}\n\n\tif (action?.hasSave) {\n\t\tconst rollData = action.getRollData();\n\t\tconst dcOffFormula = action.save.dc || '0';\n\t\tconst dcOff = RollPF.safeRollSync(dcOffFormula, rollData);\n\t\tif (dcOff.total !== 0) {\n\t\t\tconst dc = action.getDC(rollData);\n\t\t\tconst formula = o.item.spellbook.baseDCFormula + ' + ' + dcOffFormula;\n\t\t\tconst dcHint = Hint.create(i18n.get('PF1.DCThreshold', { threshold: dc }), ['dc'], { hint: formula });\n\t\t\thints.append(dcHint.element(false));\n\t\t}\n\t}\n};\n",
    "/*\n * Item value.\n */\n\nimport { descriptorIcons } from '../common.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n * @param inContainer\n */\nexport function handleValue(o, hints, inContainer) {\n\tif (o.values === 'none') return;\n\tconst item = o.item,\n\t\titemData = o.itemData,\n\t\tquantity = itemData.quantity;\n\tif (!(quantity > 0)) return;\n\n\tconst isContainer = item.type === 'container',\n\t\tisTradeGoods = itemData.subType === 'tradeGoods';\n\n\tlet showValue = false;\n\tswitch (o.values) {\n\t\tcase 'all':\n\t\t\tshowValue = true;\n\t\t// eslint-disable-next-line no-fallthrough\n\t\tcase 'expanded':\n\t\t\tif (inContainer) showValue = true;\n\t\t// eslint-disable-next-line no-fallthrough\n\t\tcase 'containers':\n\t\t\tif (isContainer) showValue = true;\n\t\t// eslint-disable-next-line no-fallthrough\n\t\tcase 'tradegoods':\n\t\t\tif (isTradeGoods) showValue = true;\n\t\t\tbreak;\n\t\tcase 'none':\n\t\t\treturn;\n\t}\n\n\tif (!showValue) return;\n\n\tconst tCost = descriptorIcons.value.clone(),\n\t\tcpSelf = item.getValue({ sellValue: 1, recursive: false, single: true, inLowestDenomination: true }),\n\t\tcpTotal = item.getValue({ sellValue: 1, recursive: true, inLowestDenomination: true });\n\n\tconst { standard, rate: rates } = pf1.config.currency;\n\tconst rate = rates[standard] ?? 1;\n\n\tconst formatNumber = Intl.NumberFormat().format;\n\tconst gpNum = (n) => formatNumber(n / rate);\n\n\tconst gpStr = `PF1.Currency.Inline.${standard}`;\n\n\tconst gpLabel = i18n.get(gpStr, { value: gpNum(cpTotal) });\n\ttCost.label = gpLabel;\n\n\tif (isContainer) {\n\t\t// const currency = item.getTotalCurrency();\n\t\ttCost.hint = i18n.get('Koboldworks.Hints.ContentsValue',\n\t\t\t{\n\t\t\t\tvalue: i18n.get(gpStr, { value: gpNum(cpSelf) }),\n\t\t\t\tcontents: i18n.get(gpStr, { value: gpNum(cpTotal - cpSelf) }),\n\t\t\t});\n\t}\n\telse {\n\t\ttCost.hint = quantity > 1 ? i18n.get('Koboldworks.Hints.ValueMult', {\n\t\t\tvalue: gpNum(cpSelf),\n\t\t\tquantity,\n\t\t\ttotal: gpLabel,\n\t\t}) : gpLabel;\n\t}\n\n\thints.append(tCost.element(o.iconize));\n}\n",
    "// Scripts\n\nimport { Hint } from '../hint.mjs';\nimport { i18n } from '../i18n.mjs';\n\n/**\n * @param {HandlerOptions} o Options\n * @param hints\n */\nexport function handleScripts(o, hints) {\n\tconst itemData = o.itemData;\n\n\tif (itemData.scriptCalls?.length) {\n\t\t// <i class=\"fa-solid fa-file-prescription\"></i>\n\t\t// fab fa-node-js\n\t\tconst scHint = Hint.create(i18n.get('Koboldworks.ItemHint.Description.ScriptCall'), ['script-call'], { icon: 'fa-solid fa-file-prescription', hint: i18n.get('Koboldworks.ItemHint.Description.ScriptCallHint') });\n\t\thints.append(scHint.element(o.iconize));\n\t}\n}\n",
    "import { handleAction } from './actions.mjs';\nimport { handleAttack } from './attack.mjs';\nimport { handleDamage } from './damage.mjs';\nimport { handleChangeFlags } from './changeflags.mjs';\nimport { handleChanges } from './changes.mjs';\nimport { handleClass } from './class.mjs';\nimport { handleContainer } from './container.mjs';\nimport { handleCustomHints } from './custom.mjs';\nimport { handleItem } from './item.mjs';\nimport { handleProficiency } from './proficiency.mjs';\nimport { handleSaves } from './saves.mjs';\nimport { handleSpell } from './spell.mjs';\nimport { handleValue } from './value.mjs';\nimport { handleScripts } from './scripts.mjs';\n\nexport const Manager = {\n\taction: handleAction,\n\tattack: handleAttack,\n\tdamage: handleDamage,\n\tchangeFlags: handleChangeFlags,\n\tchanges: handleChanges,\n\tclass: handleClass,\n\tcontainer: handleContainer,\n\tcustomHints: handleCustomHints,\n\titem: handleItem,\n\tproficiency: handleProficiency,\n\tsaves: handleSaves,\n\tspell: handleSpell,\n\tvalue: handleValue,\n\tscripts: handleScripts,\n};\n",
    "export class AppContext {\n\tisContainer = false;\n\n\t/**\n\t * @param {ActorSheet|ItemSheet} sheet\n\t * @param {HTMLElement} html\n\t */\n\tconstructor(sheet, html) {\n\t\tthis.#sheet = new WeakRef(sheet);\n\t\tthis.#html = new WeakRef(html);\n\n\t\tlet actor, item;\n\n\t\tconst doc = sheet.document;\n\t\tif (doc instanceof Actor) {\n\t\t\tactor = doc;\n\t\t}\n\t\telse {\n\t\t\titem = doc;\n\t\t}\n\n\t\tif (item) {\n\t\t\tthis.#item = new WeakRef(item);\n\t\t\tactor ??= item.actor;\n\t\t\tthis.isContainer = item.type === 'container';\n\t\t}\n\n\t\tif (actor) {\n\t\t\tthis.#actor = new WeakRef(actor);\n\t\t}\n\t}\n\n\t/** @type {WeakRef<ActorPF>|undefined} */\n\t#actor;\n\tget actor() {\n\t\treturn this.#actor?.deref();\n\t}\n\n\t/** @type {WeakRef<ItemPF>|undefined} */\n\t#item;\n\tget item() {\n\t\treturn this.#item?.deref();\n\t}\n\n\t/** @type {WeakRef<ItemSheetPF|ActorSheetPF>} */\n\t#sheet;\n\tget sheet() {\n\t\treturn this.#sheet.deref();\n\t}\n\n\t/** @type {WeakRef<HTMLElement>} */\n\t#html;\n\tget html() {\n\t\treturn this.#html.deref();\n\t}\n\n\t/** @type {Collection<ItemPF>} */\n\tget items() {\n\t\tif (this.isContainer) {\n\t\t\treturn this.item.items;\n\t\t}\n\t\telse {\n\t\t\treturn this.actor.items;\n\t\t}\n\t}\n}\n",
    "import { CFG } from './config.mjs';\nimport { AppContext } from './components/app-context.mjs';\n\nexport class HandlerOptions {\n\t/** @type {WeakRef<HTMLElement>} */\n\t#element;\n\tget element() {\n\t\treturn this.#element.deref();\n\t}\n\n\t/** @type {WeakRef<ActorPF>} */\n\t#actor;\n\tget actor() {\n\t\treturn this.#actor?.deref();\n\t}\n\n\t/** @type {WeakRef<ItemPF>} */\n\t#item;\n\tget item() {\n\t\treturn this.#item.deref();\n\t}\n\n\t/** @type {object} actor.system */\n\tget actorData() { return this.actor?.system; }\n\t/** @type {object} item.system */\n\tget itemData() { return this.item?.system; }\n\n\t/* @type {ItemAction} */\n\tget defaultAction() { return this.item?.defaultAction; }\n\n\tget isWeapon() { return this.item.type === 'weapon'; }\n\t/** @type {boolean} */\n\tget isIdentified() { return this.itemData.identified ?? true; }\n\t/** @type {number} */\n\tget enhancement() { return this.itemData.enh ?? this.itemData.armor?.enh; }\n\t/** @type {number} */\n\tget casterLevel() { return this.itemData.cl; }\n\t/** @type {boolean} */\n\tget showSecrets() { return this.isIdentified || game.user.isGM; }\n\n\t#rollData;\n\t/** @type {object} Roll data */\n\tget rollData() {\n\t\tthis.#rollData ??= this.item.getRollData({ forceRefresh: false });\n\t\treturn this.#rollData;\n\t}\n\n\ticonize = false;\n\tsanity = false;\n\thomebrew = false;\n\tchanges = false;\n\tvalues = false;\n\n\t/**\n\t * @param {Item} item\n\t * @param {Actor} actor\n\t * @param {Element} element\n\t * @param context\n\t */\n\tconstructor(item, element, context) {\n\t\tif (!(item instanceof Item)) throw new Error('`item` is not an Item');\n\t\tif (!(element instanceof HTMLElement)) throw new Error('`element` is not a HTMLElement');\n\t\tif (!(context instanceof AppContext)) throw new Error('`context` is not AppContext');\n\n\t\tthis.#item = new WeakRef(item);\n\t\tthis.#actor = item.actor ? new WeakRef(item.actor) : null;\n\t\tthis.#element = new WeakRef(element);\n\t\tthis.context = context;\n\n\t\tthis.iconize = game.settings.get(CFG.id, CFG.SETTING.iconizeSetting);\n\t\tthis.sanity = game.settings.get(CFG.id, CFG.SETTING.sanity);\n\t\tthis.homebrew = game.settings.get(CFG.id, CFG.SETTING.homebrew);\n\t\tthis.changes = game.settings.get(CFG.id, CFG.SETTING.showChanges);\n\t\tthis.values = game.settings.get(CFG.id, CFG.SETTING.showAllValues);\n\t\tthis.glow = game.settings.get(CFG.id, CFG.SETTING.glow);\n\t}\n}\n",
    "import './loader.mjs';\nimport './settings.mjs';\nimport { renderCustomHintEditor } from './editor.mjs';\nimport { HandlerOptions } from './handler-options.mjs';\nimport { AppContext } from './components/app-context.mjs';\nimport { createHints } from './create-hints.mjs';\n\n/**\n * @param {HTMLElement} el\n * @param {AppContext} context\n * @returns\n */\nasync function itemListElementHandler(el, context) {\n\tconst id = el.dataset.itemId;\n\tconst item = context.items.get(id);\n\tif (!item) return;\n\n\tconst nEl = el.querySelector('.item-name');\n\tif (!nEl) return;\n\n\tconst opts = new HandlerOptions(item, el, context);\n\tconst hints = await createHints(opts);\n\n\t// TODO: Strip unwanted hints based on... something?\n\tnEl.querySelector('h4').after(hints); // unreliable?\n};\n\n/**\n * @param {AppContext} context\n * @returns {void}\n */\nasync function injectHints(context) {\n\t// html, actor, items, isContainer\n\tconst iEls = context.html.querySelectorAll('.item-list .item');\n\tconst ps = [];\n\tfor (const el of iEls) {\n\t\tconst p = itemListElementHandler(el, context);\n\t\tps.push(p);\n\t}\n\n\tawait Promise.all(ps);\n}\n\n/**\n * @param {ItemSheet} sheet\n * @param {HTMLElement} html\n */\nfunction renderDocumentSheet(sheet, html) {\n\tif (sheet.item && sheet.item.type !== 'container') return;\n\n\tif (html instanceof jQuery) html = html[0];\n\n\tif (html.tagName !== 'FORM') html = html.querySelector('form'); // Deal with first render\n\tif (!html) return; // Weird\n\n\tinjectHints(new AppContext(sheet, html));\n}\n\nHooks.on('renderItemSheet', renderCustomHintEditor);\n\nHooks.once('ready', () => {\n\tconst hid0 = Hooks.on('renderActorSheetPF', renderDocumentSheet);\n\tconst hid1 = Hooks.on('renderItemSheetPF', renderDocumentSheet);\n\n\t// Re-order hook handlers to be the first\n\tconst events0 = Hooks.events.renderActorSheetPF;\n\tconst idx0 = events0.findIndex(h => h.id === hid0);\n\tconst [handler0] = events0.splice(idx0, 1);\n\tevents0.unshift(handler0);\n\n\tconst events1 = Hooks.events.renderItemSheetPF;\n\tconst idx1 = events1.findIndex(h => h.id === hid1);\n\tconst [handler1] = events1.splice(idx1, 1);\n\tevents1.unshift(handler1);\n});\n"
  ],
  "mappings": "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",
  "debugId": "94F588A188E0168A64756E2164756E21",
  "names": []
}